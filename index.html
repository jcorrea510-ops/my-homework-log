<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    body {background-color: #eceff2}
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s8 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s9 {font-kerning: none; color: #a7c598; background-color: #171818; -webkit-text-stroke: 0px #a7c598}
    span.s10 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
    span.s11 {font-kerning: none}
    span.s12 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s13 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s14 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">Advanced Homework Log</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* General body styling */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s8">'Inter'</span><span class="s7">,</span><span class="s1"> </span><span class="s5">sans-serif</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #f0f2f5</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Card styling for content sections */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.content-card</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s5">white</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">border-radius:</span><span class="s4"> </span><span class="s9">16px</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Slightly more rounded */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">6px</span><span class="s4"> </span><span class="s9">20px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0.08</span><span class="s5">)</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* More pronounced shadow */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.3s</span><span class="s1"> </span><span class="s5">ease</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.content-card:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">10px</span><span class="s4"> </span><span class="s9">30px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0.12</span><span class="s5">)</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Enhanced hover shadow */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Input field styling */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.class-input</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s9">100%</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s4"> </span><span class="s9">12px</span><span class="s4"> </span><span class="s9">16px</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Slightly larger padding */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s5">solid</span><span class="s1"> #cbd5e0</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Lighter border */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* More rounded corners */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s4"> </span><span class="s9">16px</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Slightly larger font */</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s4"> </span><span class="s1">border-color</span><span class="s4"> </span><span class="s9">0.2s</span><span class="s7">,</span><span class="s4"> </span><span class="s1">box-shadow</span><span class="s4"> </span><span class="s9">0.2s</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.class-input:focus</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">outline:</span><span class="s1"> </span><span class="s5">none</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">border-color:</span><span class="s4"> #6366f1</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Indigo focus color */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">3px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">99</span><span class="s7">,</span><span class="s4"> </span><span class="s9">102</span><span class="s7">,</span><span class="s4"> </span><span class="s9">241</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0.3</span><span class="s5">)</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Softer focus shadow */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Drag and drop styling */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.task-item</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">cursor:</span><span class="s1"> </span><span class="s5">grab</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">user-select:</span><span class="s1"> </span><span class="s5">none</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.task-item.dragging</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">opacity:</span><span class="s4"> </span><span class="s9">0.6</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Slightly more transparent when dragging */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #eef2ff</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Lighter indigo background */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">4px</span><span class="s4"> </span><span class="s9">15px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0.1</span><span class="s5">)</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Shadow for dragging item */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Completed task styling in timeline */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.timeline-item.completed</span><span class="s4"> </span><span class="s1">span</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">text-decoration:</span><span class="s4"> </span><span class="s5">line-through</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> #9ca3af</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Enhanced button styling */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-primary</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #6366f1</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Tailwind indigo-500 equivalent */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> </span><span class="s5">white</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">12px</span><span class="s1"> </span><span class="s9">24px</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">600</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">4px</span><span class="s1"> </span><span class="s9">10px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">99</span><span class="s7">,</span><span class="s1"> </span><span class="s9">102</span><span class="s7">,</span><span class="s1"> </span><span class="s9">241</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.3</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.2s</span><span class="s1"> </span><span class="s5">ease-in-out</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">display:</span><span class="s1"> </span><span class="s5">flex</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">align-items:</span><span class="s1"> </span><span class="s5">center</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">justify-content:</span><span class="s4"> </span><span class="s5">center</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">gap:</span><span class="s1"> </span><span class="s9">8px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-primary:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #4f46e5</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Darker indigo on hover */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">6px</span><span class="s1"> </span><span class="s9">15px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">99</span><span class="s7">,</span><span class="s1"> </span><span class="s9">102</span><span class="s7">,</span><span class="s1"> </span><span class="s9">241</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.4</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s9">-1px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-green</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #22c55e</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Tailwind green-500 equivalent */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> </span><span class="s5">white</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">10px</span><span class="s1"> </span><span class="s9">20px</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">500</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">3px</span><span class="s1"> </span><span class="s9">8px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">34</span><span class="s7">,</span><span class="s1"> </span><span class="s9">197</span><span class="s7">,</span><span class="s1"> </span><span class="s9">94</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.2</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.2s</span><span class="s1"> </span><span class="s5">ease-in-out</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-green:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #16a34a</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Darker green on hover */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">4px</span><span class="s1"> </span><span class="s9">10px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">34</span><span class="s7">,</span><span class="s1"> </span><span class="s9">197</span><span class="s7">,</span><span class="s1"> </span><span class="s9">94</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.3</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s9">-1px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.btn-red</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s4"> #ef4444</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Tailwind red-500 equivalent */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.2s</span><span class="s1"> </span><span class="s5">ease-in-out</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-red:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s4"> #dc2626</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Darker red on hover */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s9">-1px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-secondary</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #e5e7eb</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Tailwind gray-200 */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s4"> #4b5563</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Tailwind gray-700 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">10px</span><span class="s1"> </span><span class="s9">20px</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">500</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.2s</span><span class="s1"> </span><span class="s5">ease-in-out</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-secondary:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #d1d5db</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Tailwind gray-300 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Responsive adjustments for calendar grid */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span>@</span><span class="s6">media</span><span class="s4"> (</span><span class="s6">min-width:</span><span class="s4"> 768</span><span class="s6">px</span><span class="s4">) </span><span class="s7">{</span><span class="s4"> </span><span class="s1">/* md breakpoint */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>#calendar-grid {</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">grid-template-columns:</span><span class="s4"> </span><span class="s5">repeat(</span><span class="s9">3</span><span class="s7">,</span><span class="s4"> </span><span class="s9">1fr</span><span class="s5">)</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* 3 columns on medium screens */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>@</span><span class="s6">media</span><span class="s1"> (</span><span class="s6">min-width:</span><span class="s1"> 1024</span><span class="s6">px</span><span class="s1">) </span><span class="s7">{</span><span class="s1"> </span><span class="s10">/* lg breakpoint */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>#calendar-grid {</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">grid-template-columns:</span><span class="s4"> </span><span class="s5">repeat(</span><span class="s9">5</span><span class="s7">,</span><span class="s4"> </span><span class="s9">1fr</span><span class="s5">)</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* 5 columns on large screens */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Login Page Specific Styles */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#login-page</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">display:</span><span class="s1"> </span><span class="s5">flex</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">justify-content:</span><span class="s4"> </span><span class="s5">center</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">align-items:</span><span class="s1"> </span><span class="s5">center</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">min-height:</span><span class="s1"> </span><span class="s9">100vh</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #f0f2f5</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.login-card</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s5">white</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">40px</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">16px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">10px</span><span class="s1"> </span><span class="s9">30px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.1</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s9">100%</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">max-width:</span><span class="s1"> </span><span class="s9">450px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">text-align:</span><span class="s1"> </span><span class="s5">center</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.login-input</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s9">100%</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">12px</span><span class="s1"> </span><span class="s9">16px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s5">solid</span><span class="s1"> #cbd5e0</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s1"> </span><span class="s9">16px</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">margin-bottom:</span><span class="s4"> </span><span class="s9">15px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.login-input:focus</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">outline:</span><span class="s1"> </span><span class="s5">none</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border-color:</span><span class="s1"> #6366f1</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">3px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">99</span><span class="s7">,</span><span class="s1"> </span><span class="s9">102</span><span class="s7">,</span><span class="s1"> </span><span class="s9">241</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.3</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.auth-message</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">margin-top:</span><span class="s1"> </span><span class="s9">15px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">10px</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">8px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">500</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.auth-message.error</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #fee2e2</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Red-100 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> #dc2626</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Red-600 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.auth-message.success</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #d1fae5</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Green-100 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> #10b981</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Green-600 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Loading Spinner */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.spinner</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s1"> </span><span class="s9">4px</span><span class="s1"> </span><span class="s5">solid</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.1</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border-left-color:</span><span class="s1"> #6366f1</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Indigo */</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">50%</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s9">24px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s9">24px</span><span class="s7">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">animation:</span><span class="s4"> </span><span class="s1">spin</span><span class="s4"> </span><span class="s9">1s</span><span class="s4"> </span><span class="s1">linear</span><span class="s4"> </span><span class="s1">infinite</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">@keyframes</span><span class="s1"> </span><span class="s5">spin</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">0%</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">rotate(</span><span class="s9">0deg</span><span class="s5">)</span><span class="s7">;</span><span class="s1"> </span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">100%</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">rotate(</span><span class="s9">360deg</span><span class="s5">)</span><span class="s7">;</span><span class="s1"> </span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"p-4 sm:p-6 lg:p-8"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Login/Registration Page --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"login-page"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"login-card"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold text-gray-800 mb-6"</span><span class="s3">&gt;</span><span class="s4">Welcome to Homework Log</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-gray-600 mb-6"</span><span class="s3">&gt;</span><span class="s1">Log in or register to manage your homework across all your devices.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"auth-username"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"login-input"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Username"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"password"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"auth-password"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"login-input"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Password"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col sm:flex-row gap-3 mt-4"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"register-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-primary flex-grow py-3"</span><span class="s3">&gt;</span><span class="s4">Register</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"login-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-green flex-grow py-3"</span><span class="s3">&gt;</span><span class="s4">Login</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"auth-message"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"auth-message hidden"</span><span class="s3">&gt;&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Main Homework Log Application Content --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"app-content"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mb-10 mt-4 flex justify-between items-center"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex-grow text-center"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-5xl font-extrabold text-gray-800 mb-2"</span><span class="s3">&gt;</span><span class="s4">Advanced Homework Log</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-gray-600 text-lg"</span><span class="s3">&gt;</span><span class="s1">Plan your week, organize your night. Stay on top of your studies.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"user-id-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-2 text-sm font-medium text-gray-400"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"logout-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-secondary px-4 py-2 text-base"</span><span class="s3">&gt;</span><span class="s4">Logout</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">header</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">main</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 gap-10"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Calendar Section --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"content-card p-6 sm:p-8"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col sm:flex-row justify-between items-center mb-6"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"prev-week"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-primary mb-3 sm:mb-0"</span><span class="s3">&gt;&lt;</span><span class="s6">i</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fas fa-chevron-left"</span><span class="s3">&gt;&lt;/</span><span class="s6">i</span><span class="s3">&gt;</span><span class="s4"> Previous Week</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"week-title"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold text-gray-700 text-center flex-grow"</span><span class="s3">&gt;&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"next-week"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-primary mt-3 sm:mt-0"</span><span class="s3">&gt;</span><span class="s4">Next Week </span><span class="s3">&lt;</span><span class="s6">i</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fas fa-chevron-right"</span><span class="s3">&gt;&lt;/</span><span class="s6">i</span><span class="s3">&gt;&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"calendar-grid"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 gap-4"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">&lt;!-- Day columns will be generated by JS --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Schedule Section --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"content-card p-6 sm:p-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col sm:flex-row justify-between sm:items-center mb-6"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-3xl font-bold text-gray-800"</span><span class="s3">&gt;</span><span class="s1">Tonight's Schedule</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"tonight-date"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-semibold text-gray-600 mt-1"</span><span class="s3">&gt;&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-md text-gray-500 mt-2"</span><span class="s3">&gt;</span><span class="s1">Tasks due tomorrow. Drag to reorder, click to mark complete.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"total-time-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-4 sm:mt-0 text-xl font-bold text-indigo-700 bg-indigo-100 px-5 py-2 rounded-xl shadow-md"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>Total Time: 0m</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"schedule-list"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"space-y-4 mb-6"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">&lt;!-- Schedule items will be generated by JS --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col sm:flex-row gap-3 mb-6"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"custom-task-input"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Add another task, e.g., 'Review notes for 30 min'"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"class-input flex-grow"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"add-task-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-green"</span><span class="s3">&gt;&lt;</span><span class="s6">i</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fas fa-plus"</span><span class="s3">&gt;&lt;/</span><span class="s6">i</span><span class="s3">&gt;</span><span class="s4"> Add Task</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"border-t border-gray-200 pt-6"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold text-xl text-gray-700 mb-4"</span><span class="s3">&gt;</span><span class="s1">Generate Your Timeline</span><span class="s3">&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col sm:flex-row items-center gap-4 mb-5"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"start-time"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-gray-600 text-lg flex-shrink-0"</span><span class="s3">&gt;</span><span class="s4">Start first task at:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"time"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"start-time"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"class-input w-full sm:w-40"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"generate-schedule-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-primary w-full py-4"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">i</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"fas fa-magic-wand-sparkles"</span><span class="s3">&gt;&lt;/</span><span class="s6">i</span><span class="s3">&gt;</span><span class="s1"> Generate Today's Plan</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"timeline-output"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-8 space-y-4"</span><span class="s3">&gt;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">&lt;!-- Generated timeline will appear here --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">main</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Firebase Imports - These modules are loaded from a CDN.</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">import</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> initializeApp </span><span class="s7">}</span><span class="s4"> </span><span class="s12">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">import</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> getFirestore</span><span class="s7">,</span><span class="s1"> setDoc</span><span class="s7">,</span><span class="s1"> doc</span><span class="s7">,</span><span class="s1"> getDoc</span><span class="s7">,</span><span class="s1"> onSnapshot</span><span class="s7">,</span><span class="s1"> collection</span><span class="s7">,</span><span class="s1"> query </span><span class="s7">}</span><span class="s1"> </span><span class="s12">from</span><span class="s1"> </span><span class="s8">"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">import</span><span class="s1"> </span><span class="s7">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getAuth</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>createUserWithEmailAndPassword</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>signInWithEmailAndPassword</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>signOut</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>onAuthStateChanged</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setPersistence</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>browserLocalPersistence </span><span class="s10">// For persisting user session</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s7">}</span><span class="s4"> </span><span class="s12">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Firebase Configuration (HARDCODED) ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// IMPORTANT: Ensure these values are correct from your Firebase project.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> firebaseConfig </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>apiKey</span><span class="s7">:</span><span class="s4"> </span><span class="s1">"AIzaSyBeyx0HKLSrolgXgl3rt19f8KLcCUagIGE"</span><span class="s7">,</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>authDomain</span><span class="s7">:</span><span class="s4"> </span><span class="s1">"homework-log-77252.firebaseapp.com"</span><span class="s7">,</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>projectId</span><span class="s7">:</span><span class="s1"> </span><span class="s8">"homework-log-77252"</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>storageBucket</span><span class="s7">:</span><span class="s4"> </span><span class="s1">"homework-log-77252.firebasestorage.app"</span><span class="s7">,</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>messagingSenderId</span><span class="s7">:</span><span class="s1"> </span><span class="s8">"46201812827"</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>appId</span><span class="s7">:</span><span class="s4"> </span><span class="s1">"1:46201812827:web:2f4c8ecf01966c9c340c7e"</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> effectiveAppId </span><span class="s7">=</span><span class="s1"> firebaseConfig</span><span class="s7">.</span><span class="s1">projectId</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Global Firebase Instances and User State ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> app</span><span class="s7">,</span><span class="s1"> db</span><span class="s7">,</span><span class="s1"> auth</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s4"> userId </span><span class="s7">=</span><span class="s4"> </span><span class="s12">null</span><span class="s7">;</span><span class="s4"> </span><span class="s1">// This will hold the Firebase Auth UID of the logged-in user</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> isAuthReady </span><span class="s7">=</span><span class="s1"> </span><span class="s12">false</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Firestore unsubscribe functions to manage listeners and prevent memory leaks.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> homeworkUnsubscribe </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> scheduleUnsubscribe </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> tomorrowHwUnsubscribe </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// In-memory stores (fallback, not used when Firebase is connected)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> localHomeworkData </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{};</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> localScheduleData </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> tasks</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[],</span><span class="s1"> startTime</span><span class="s7">:</span><span class="s1"> </span><span class="s8">''</span><span class="s1"> </span><span class="s7">};</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Predefined class names for the calendar grid</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s4"> </span><span class="s13">CLASS_NAMES</span><span class="s4"> </span><span class="s7">=</span><span class="s4"> </span><span class="s7">[</span><span class="s1">"Chem"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"SR"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"CompS"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Alg"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Eng"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"World"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Span"</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Other"</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> currentMonday </span><span class="s7">=</span><span class="s1"> getStartOfWeek</span><span class="s7">(</span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">());</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- DOM Elements ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> calendarGrid </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'calendar-grid'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> weekTitle </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'week-title'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> scheduleList </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'schedule-list'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> tonightDateEl </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'tonight-date'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> timelineOutput </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'timeline-output'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> totalTimeDisplay </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'total-time-display'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> userIdDisplay </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'user-id-display'</span><span class="s7">);</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Login Page Elements</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> loginPage </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'login-page'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> appContent </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'app-content'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> authUsernameInput </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'auth-username'</span><span class="s7">);</span><span class="s1"> </span><span class="s10">// Changed from authEmailInput</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> authPasswordInput </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'auth-password'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> registerBtn </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'register-btn'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> loginBtn </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'login-btn'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> logoutBtn </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'logout-btn'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> authMessage </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'auth-message'</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Initial App Load ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'DOMContentLoaded'</span><span class="s7">,</span><span class="s1"> initializeAppAndAuth</span><span class="s7">);</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> initializeAppAndAuth</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"initializeAppAndAuth: Starting initialization process."</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Initialize Firebase App</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>app </span><span class="s7">=</span><span class="s1"> initializeApp</span><span class="s7">(</span><span class="s1">firebaseConfig</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>auth </span><span class="s7">=</span><span class="s1"> getAuth</span><span class="s7">(</span><span class="s1">app</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>db </span><span class="s7">=</span><span class="s1"> getFirestore</span><span class="s7">(</span><span class="s1">app</span><span class="s7">);</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// --- Set Firebase Auth Persistence ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// This ensures the user session persists across browser sessions.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> setPersistence</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">,</span><span class="s1"> browserLocalPersistence</span><span class="s7">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">.</span><span class="s1">then</span><span class="s7">(()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Firebase persistence set to LOCAL."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">})</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">.</span><span class="s12">catch</span><span class="s7">((</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Error setting Firebase persistence:"</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>displayAuthMessage</span><span class="s7">(</span><span class="s8">`Error setting session persistence: </span><span class="s7">${</span><span class="s1">error</span><span class="s7">.</span><span class="s1">message</span><span class="s7">}</span><span class="s8">`</span><span class="s7">,</span><span class="s1"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// --- Listen for Auth State Changes ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// This listener will be triggered whenever a user logs in, logs out, or the session restores.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>onAuthStateChanged</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">user</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"onAuthStateChanged: Auth state changed. User:"</span><span class="s7">,</span><span class="s4"> user </span><span class="s7">?</span><span class="s4"> user</span><span class="s7">.</span><span class="s4">uid </span><span class="s7">:</span><span class="s4"> </span><span class="s1">"null"</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">user</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// User is signed in.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>userId </span><span class="s7">=</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">uid</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>isAuthReady </span><span class="s7">=</span><span class="s1"> </span><span class="s12">true</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Display only the username part if it matches our dummy domain</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> displayUsername </span><span class="s7">=</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">email </span><span class="s7">&amp;&amp;</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">email</span><span class="s7">.</span><span class="s1">endsWith</span><span class="s7">(</span><span class="s8">'@homeworklog.app'</span><span class="s7">)</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">?</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">email</span><span class="s7">.</span><span class="s1">split</span><span class="s7">(</span><span class="s8">'@'</span><span class="s7">)[</span><span class="s14">0</span><span class="s7">]</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">:</span><span class="s1"> user</span><span class="s7">.</span><span class="s1">email </span><span class="s7">||</span><span class="s1"> </span><span class="s8">'Anonymous'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>userIdDisplay</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`Logged in as: </span><span class="s7">${</span><span class="s1">displayUsername</span><span class="s7">}</span><span class="s8"> (ID: </span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">)`</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>showAppUI</span><span class="s7">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Set up Firestore data listeners for the logged-in user</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>setupDataListeners</span><span class="s7">();</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>setupTomorrowHomeworkListener</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// User is signed out.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>userId </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>isAuthReady </span><span class="s7">=</span><span class="s1"> </span><span class="s12">false</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>showLoginUI</span><span class="s7">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Clear listeners and local data if no user is authenticated</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">homeworkUnsubscribe</span><span class="s7">)</span><span class="s1"> homeworkUnsubscribe</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">scheduleUnsubscribe</span><span class="s7">)</span><span class="s1"> scheduleUnsubscribe</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">tomorrowHwUnsubscribe</span><span class="s7">)</span><span class="s1"> tomorrowHwUnsubscribe</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>renderScheduleList</span><span class="s7">([]);</span><span class="s1"> </span><span class="s10">// Clear the displayed schedule</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>userIdDisplay</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`Please log in.`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Set up initial UI state based on current auth state (will be overridden by onAuthStateChanged)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">auth</span><span class="s7">.</span><span class="s1">currentUser</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>showAppUI</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>showLoginUI</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Initial rendering of calendar and tomorrow's schedule (may load empty if not logged in)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderWeek</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setupTomorrowHomeworkListener</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- UI State Management ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> showAppUI</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>loginPage</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>appContent</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>displayAuthMessage</span><span class="s7">(</span><span class="s8">''</span><span class="s7">,</span><span class="s1"> </span><span class="s12">false</span><span class="s7">);</span><span class="s1"> </span><span class="s10">// Clear any auth messages</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> showLoginUI</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>loginPage</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>appContent</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>authUsernameInput</span><span class="s7">.</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span><span class="s1"> </span><span class="s10">// Changed from authEmailInput</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>authPasswordInput</span><span class="s7">.</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> displayAuthMessage</span><span class="s7">(</span><span class="s1">message</span><span class="s7">,</span><span class="s1"> isError</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>authMessage</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> message</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>authMessage</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'error'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'success'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">message</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>authMessage</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s1">isError </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'error'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'success'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>authMessage</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span><span class="s1"> </span><span class="s10">// Hide if message is empty</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Firebase Authentication Functions ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s4"> </span><span class="s13">DUMMY_DOMAIN</span><span class="s4"> </span><span class="s7">=</span><span class="s4"> </span><span class="s8">'@homeworklog.app'</span><span class="s7">;</span><span class="s4"> </span><span class="s1">// Define the dummy domain</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleRegister</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> username </span><span class="s7">=</span><span class="s1"> authUsernameInput</span><span class="s7">.</span><span class="s1">value</span><span class="s7">.</span><span class="s1">trim</span><span class="s7">();</span><span class="s1"> </span><span class="s10">// Get username</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> password </span><span class="s7">=</span><span class="s1"> authPasswordInput</span><span class="s7">.</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> email </span><span class="s7">=</span><span class="s1"> username </span><span class="s7">+</span><span class="s1"> </span><span class="s13">DUMMY_DOMAIN</span><span class="s7">;</span><span class="s1"> </span><span class="s10">// Construct dummy email</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">username </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">password</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Please enter both username and password."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">username</span><span class="s7">.</span><span class="s4">includes</span><span class="s7">(</span><span class="s8">'@'</span><span class="s7">))</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> </span><span class="s1">// Prevent user from entering @ if we're adding dummy domain</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Username cannot contain '@' symbol."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Creates a new user with email (dummy) and password</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">await</span><span class="s1"> createUserWithEmailAndPassword</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">,</span><span class="s1"> email</span><span class="s7">,</span><span class="s1"> password</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Registration successful! You are now logged in."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">false</span><span class="s7">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// onAuthStateChanged will handle UI update</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Registration error:"</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">.</span><span class="s1">code </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'auth/email-already-in-use'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Registration failed: That username is already taken. Please choose another."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">.</span><span class="s1">code </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'auth/weak-password'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Registration failed: Password should be at least 6 characters."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>displayAuthMessage</span><span class="s7">(</span><span class="s8">`Registration failed: </span><span class="s7">${</span><span class="s1">error</span><span class="s7">.</span><span class="s1">message</span><span class="s7">}</span><span class="s8">`</span><span class="s7">,</span><span class="s1"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleLogin</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> username </span><span class="s7">=</span><span class="s1"> authUsernameInput</span><span class="s7">.</span><span class="s1">value</span><span class="s7">.</span><span class="s1">trim</span><span class="s7">();</span><span class="s1"> </span><span class="s10">// Get username</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> password </span><span class="s7">=</span><span class="s1"> authPasswordInput</span><span class="s7">.</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> email </span><span class="s7">=</span><span class="s1"> username </span><span class="s7">+</span><span class="s1"> </span><span class="s13">DUMMY_DOMAIN</span><span class="s7">;</span><span class="s1"> </span><span class="s10">// Construct dummy email</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">username </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">password</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Please enter both username and password."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">username</span><span class="s7">.</span><span class="s4">includes</span><span class="s7">(</span><span class="s8">'@'</span><span class="s7">))</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> </span><span class="s1">// Prevent user from entering @ if we're adding dummy domain</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Username cannot contain '@' symbol."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Signs in an existing user</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">await</span><span class="s1"> signInWithEmailAndPassword</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">,</span><span class="s1"> email</span><span class="s7">,</span><span class="s1"> password</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s8">"Login successful!"</span><span class="s7">,</span><span class="s1"> </span><span class="s12">false</span><span class="s7">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// onAuthStateChanged will handle UI update</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Login error:"</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">.</span><span class="s1">code </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'auth/user-not-found'</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> error</span><span class="s7">.</span><span class="s1">code </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'auth/wrong-password'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>displayAuthMessage</span><span class="s7">(</span><span class="s1">"Login failed: Incorrect username or password."</span><span class="s7">,</span><span class="s4"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>displayAuthMessage</span><span class="s7">(</span><span class="s8">`Login failed: </span><span class="s7">${</span><span class="s1">error</span><span class="s7">.</span><span class="s1">message</span><span class="s7">}</span><span class="s8">`</span><span class="s7">,</span><span class="s1"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> handleLogout</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">await</span><span class="s1"> signOut</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s8">"Logged out successfully."</span><span class="s7">,</span><span class="s1"> </span><span class="s12">false</span><span class="s7">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// onAuthStateChanged will handle UI update</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Logout error:"</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>displayAuthMessage</span><span class="s7">(</span><span class="s8">`Logout failed: </span><span class="s7">${</span><span class="s1">error</span><span class="s7">.</span><span class="s1">message</span><span class="s7">}</span><span class="s8">`</span><span class="s7">,</span><span class="s1"> </span><span class="s12">true</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Date Helper Functions ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Calculates the Monday of the week for a given date.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Date} date - The date to find the week's Monday for.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @returns {Date} - The Date object for the Monday of that week.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> getStartOfWeek</span><span class="s7">(</span><span class="s1">date</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> d </span><span class="s7">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">(</span><span class="s1">date</span><span class="s7">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s4"> day </span><span class="s7">=</span><span class="s4"> d</span><span class="s7">.</span><span class="s4">getDay</span><span class="s7">();</span><span class="s4"> </span><span class="s1">// 0 for Sunday, 1 for Monday, etc.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> diff </span><span class="s7">=</span><span class="s1"> d</span><span class="s7">.</span><span class="s1">getDate</span><span class="s7">()</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> day </span><span class="s7">+</span><span class="s1"> </span><span class="s7">(</span><span class="s1">day </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s7">-</span><span class="s14">6</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s14">1</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">(</span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">(</span><span class="s1">d</span><span class="s7">.</span><span class="s1">setDate</span><span class="s7">(</span><span class="s1">diff</span><span class="s7">)).</span><span class="s1">setHours</span><span class="s7">(</span><span class="s14">0</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Formats a Date object into a 'YYYY-MM-DD' string.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Date} date - The date to format.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @returns {string} - The formatted date string.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s1">date</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> date</span><span class="s7">.</span><span class="s1">toISOString</span><span class="s7">().</span><span class="s1">split</span><span class="s7">(</span><span class="s8">'T'</span><span class="s7">)[</span><span class="s14">0</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Calculates the date for "tomorrow" based on a specific logic:</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Mon-Thu -&gt; actual next day.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Fri, Sat, Sun -&gt; next Monday.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @returns {Date} - The Date object for the calculated "tomorrow".</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> getTomorrowDate</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> tomorrow </span><span class="s7">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dayOfWeek </span><span class="s7">=</span><span class="s1"> tomorrow</span><span class="s7">.</span><span class="s1">getDay</span><span class="s7">();</span><span class="s1"> </span><span class="s10">// 0 for Sunday, 1 for Monday, etc.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">dayOfWeek </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s14">1</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> dayOfWeek </span><span class="s7">&lt;=</span><span class="s1"> </span><span class="s14">4</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>tomorrow</span><span class="s7">.</span><span class="s1">setDate</span><span class="s7">(</span><span class="s1">tomorrow</span><span class="s7">.</span><span class="s1">getDate</span><span class="s7">()</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s14">1</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> daysUntilMonday </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s14">8</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> dayOfWeek</span><span class="s7">)</span><span class="s1"> </span><span class="s7">%</span><span class="s1"> </span><span class="s14">7</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>tomorrow</span><span class="s7">.</span><span class="s1">setDate</span><span class="s7">(</span><span class="s1">tomorrow</span><span class="s7">.</span><span class="s1">getDate</span><span class="s7">()</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s7">(</span><span class="s1">daysUntilMonday </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s14">1</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> daysUntilMonday</span><span class="s7">));</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">(</span><span class="s1">tomorrow</span><span class="s7">.</span><span class="s1">setHours</span><span class="s7">(</span><span class="s14">0</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Calendar &amp; UI Rendering ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Renders the calendar grid for the current week.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderWeek</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"renderWeek: Rendering current week."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calendarGrid</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> start </span><span class="s7">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">(</span><span class="s1">currentMonday</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>weekTitle</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`Week of </span><span class="s7">${</span><span class="s1">start</span><span class="s7">.</span><span class="s1">toLocaleDateString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> month</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'long'</span><span class="s7">,</span><span class="s1"> day</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'numeric'</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">`</span><span class="s7">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> </span><span class="s7">(</span><span class="s12">let</span><span class="s1"> i </span><span class="s7">=</span><span class="s1"> </span><span class="s14">0</span><span class="s7">;</span><span class="s1"> i </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s14">5</span><span class="s7">;</span><span class="s1"> i</span><span class="s7">++)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> dayDate </span><span class="s7">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">(</span><span class="s1">start</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>dayDate</span><span class="s7">.</span><span class="s1">setDate</span><span class="s7">(</span><span class="s1">start</span><span class="s7">.</span><span class="s1">getDate</span><span class="s7">()</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> i</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>createDayColumn</span><span class="s7">(</span><span class="s1">dayDate</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">db </span><span class="s7">&amp;&amp;</span><span class="s1"> auth </span><span class="s7">&amp;&amp;</span><span class="s1"> isAuthReady</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>setupDataListeners</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Creates and appends a single day column to the calendar grid.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Date} date - The date for which to create the column.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> createDayColumn</span><span class="s7">(</span><span class="s1">date</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dateString </span><span class="s7">=</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s1">date</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> col </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'div'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>col</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'p-4 bg-gray-50 rounded-xl space-y-3 shadow-sm'</span><span class="s7">;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>col</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="text-center pb-2 border-b border-gray-100 mb-3"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h3 class="font-bold text-lg text-gray-800"&gt;</span><span class="s7">${</span><span class="s4">date</span><span class="s7">.</span><span class="s4">toLocaleDateString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> weekday</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'short'</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">&lt;/h3&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;p class="text-sm text-gray-500"&gt;</span><span class="s7">${</span><span class="s4">date</span><span class="s7">.</span><span class="s4">toLocaleDateString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> month</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'numeric'</span><span class="s7">,</span><span class="s4"> day</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'numeric'</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">${</span><span class="s13">CLASS_NAMES</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">name </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex items-center gap-3"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label class="font-medium text-sm text-gray-700 w-16 text-right flex-shrink-0"&gt;</span><span class="s7">${</span><span class="s4">name</span><span class="s7">}</span><span class="s1">:&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="hw-</span><span class="s7">${</span><span class="s4">dateString</span><span class="s7">}</span><span class="s1">-</span><span class="s7">${</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" data-date="</span><span class="s7">${</span><span class="s4">dateString</span><span class="s7">}</span><span class="s1">" data-class="</span><span class="s7">${</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" class="class-input" placeholder="Assignment..."&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calendarGrid</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">col</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Data Handling ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Sets up real-time Firestore listeners for homework and today's schedule.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Unsubscribes from previous listeners to prevent memory leaks.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> setupDataListeners</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Firestore paths will now use `userId` (Firebase Auth UID)</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"setupDataListeners: Setting up Firestore listeners for appId:"</span><span class="s7">,</span><span class="s4"> effectiveAppId</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"userId:"</span><span class="s7">,</span><span class="s4"> userId</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">db </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">auth </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">isAuthReady </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">userId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">warn</span><span class="s7">(</span><span class="s1">"setupDataListeners: Firebase not ready or userId not available. Skipping listeners."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">homeworkUnsubscribe</span><span class="s7">)</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> homeworkUnsubscribe</span><span class="s7">();</span><span class="s4"> console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"setupDataListeners: Unsubscribed from previous homework listener."</span><span class="s7">);</span><span class="s4"> </span><span class="s7">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">scheduleUnsubscribe</span><span class="s7">)</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> scheduleUnsubscribe</span><span class="s7">();</span><span class="s4"> console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"setupDataListeners: Unsubscribed from previous schedule listener."</span><span class="s7">);</span><span class="s4"> </span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> hwQuery </span><span class="s7">=</span><span class="s1"> query</span><span class="s7">(</span><span class="s1">collection</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">effectiveAppId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">/homework`</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>homeworkUnsubscribe </span><span class="s7">=</span><span class="s1"> onSnapshot</span><span class="s7">(</span><span class="s1">hwQuery</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">snapshot</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"onSnapshot(homework): Homework data updated. Number of docs:"</span><span class="s7">,</span><span class="s4"> snapshot</span><span class="s7">.</span><span class="s4">docs</span><span class="s7">.</span><span class="s4">length</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>snapshot</span><span class="s7">.</span><span class="s1">docs</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">docSnap </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s13">CLASS_NAMES</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">className </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">const</span><span class="s1"> input </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">`hw-</span><span class="s7">${</span><span class="s1">docSnap</span><span class="s7">.</span><span class="s1">id</span><span class="s7">}</span><span class="s8">-</span><span class="s7">${</span><span class="s1">className</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">input </span><span class="s7">&amp;&amp;</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">activeElement </span><span class="s7">!==</span><span class="s1"> input</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                           </span>input</span><span class="s7">.</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> docSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">()[</span><span class="s1">className</span><span class="s7">]</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">},</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Error fetching homework: "</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> todayDate </span><span class="s7">=</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scheduleDocRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">effectiveAppId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">/schedules`</span><span class="s7">,</span><span class="s1"> todayDate</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>scheduleUnsubscribe </span><span class="s7">=</span><span class="s1"> onSnapshot</span><span class="s7">(</span><span class="s1">scheduleDocRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">docSnap</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"onSnapshot(schedule): Schedule data updated. Doc exists:"</span><span class="s7">,</span><span class="s4"> docSnap</span><span class="s7">.</span><span class="s4">exists</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">docSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">())</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> data </span><span class="s7">=</span><span class="s1"> docSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>renderScheduleList</span><span class="s7">(</span><span class="s1">data</span><span class="s7">.</span><span class="s1">tasks </span><span class="s7">||</span><span class="s1"> </span><span class="s7">[]);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">data</span><span class="s7">.</span><span class="s1">startTime</span><span class="s7">)</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start-time'</span><span class="s7">).</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> data</span><span class="s7">.</span><span class="s1">startTime</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>renderScheduleList</span><span class="s7">([]);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">},</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Error fetching schedule: "</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Sets up a real-time Firestore listener for tomorrow's homework.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* This triggers an update to "Tonight's Schedule" when tomorrow's homework changes.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> setupTomorrowHomeworkListener</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> tomorrow </span><span class="s7">=</span><span class="s1"> getTomorrowDate</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>tonightDateEl</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`For </span><span class="s7">${</span><span class="s1">tomorrow</span><span class="s7">.</span><span class="s1">toLocaleDateString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> weekday</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'long'</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">, </span><span class="s7">${</span><span class="s1">tomorrow</span><span class="s7">.</span><span class="s1">toLocaleDateString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> month</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'long'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'day'</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'numeric'</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">`</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"setupTomorrowHomeworkListener: Setting up tomorrow's homework listener for appId:"</span><span class="s7">,</span><span class="s4"> effectiveAppId</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"userId:"</span><span class="s7">,</span><span class="s4"> userId</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">db </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">auth </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">isAuthReady </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">userId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">warn</span><span class="s7">(</span><span class="s1">"setupTomorrowHomeworkListener: Firebase not ready or userId not available. Skipping listener, updating schedule with local data."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>updateTonightSchedule</span><span class="s7">();</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">tomorrowHwUnsubscribe</span><span class="s7">)</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> tomorrowHwUnsubscribe</span><span class="s7">();</span><span class="s4"> console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"setupTomorrowHomeworkListener: Unsubscribed from previous tomorrow HW listener."</span><span class="s7">);</span><span class="s4"> </span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> tomorrowDateString </span><span class="s7">=</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s1">tomorrow</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> hwDocRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">effectiveAppId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">/homework`</span><span class="s7">,</span><span class="s1"> tomorrowDateString</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>tomorrowHwUnsubscribe </span><span class="s7">=</span><span class="s1"> onSnapshot</span><span class="s7">(</span><span class="s1">hwDocRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"onSnapshot(tomorrowHW): Tomorrow's homework data updated. Triggering updateTonightSchedule."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>updateTonightSchedule</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">},</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">error</span><span class="s7">(</span><span class="s1">"Error fetching tomorrow's homework: "</span><span class="s7">,</span><span class="s4"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Updates "Tonight's Schedule" by merging homework due tomorrow with custom tasks.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* This function is called when tomorrow's homework or today's schedule changes.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> updateTonightSchedule</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Updating tonight's schedule."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> tomorrowDateString </span><span class="s7">=</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s1">getTomorrowDate</span><span class="s7">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> todayDate </span><span class="s7">=</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">());</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> hwTasks </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">db </span><span class="s7">&amp;&amp;</span><span class="s1"> auth </span><span class="s7">&amp;&amp;</span><span class="s1"> isAuthReady </span><span class="s7">&amp;&amp;</span><span class="s1"> userId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Fetching tomorrow's homework from Firestore."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> hwDocRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">effectiveAppId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">/homework`</span><span class="s7">,</span><span class="s1"> tomorrowDateString</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> hwDocSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">hwDocRef</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">hwDocSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">())</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> data </span><span class="s7">=</span><span class="s1"> hwDocSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>hwTasks </span><span class="s7">=</span><span class="s1"> </span><span class="s13">CLASS_NAMES</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">name </span><span class="s7">=&gt;</span><span class="s1"> data</span><span class="s7">[</span><span class="s1">name</span><span class="s7">]).</span><span class="s1">map</span><span class="s7">(</span><span class="s1">name </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span><span class="s1"> text</span><span class="s7">:</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">name</span><span class="s7">}</span><span class="s8">: </span><span class="s7">${</span><span class="s1">data</span><span class="s7">[</span><span class="s1">name</span><span class="s7">]}</span><span class="s8">`</span><span class="s7">,</span><span class="s1"> hwClass</span><span class="s7">:</span><span class="s1"> name </span><span class="s7">}));</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Found homework tasks:"</span><span class="s7">,</span><span class="s4"> hwTasks</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: No homework document found for tomorrow."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Operating offline, fetching homework from local memory."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> data </span><span class="s7">=</span><span class="s1"> localHomeworkData</span><span class="s7">[</span><span class="s1">tomorrowDateString</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">data</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>hwTasks </span><span class="s7">=</span><span class="s1"> </span><span class="s13">CLASS_NAMES</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">name </span><span class="s7">=&gt;</span><span class="s1"> data</span><span class="s7">[</span><span class="s1">name</span><span class="s7">]).</span><span class="s1">map</span><span class="s7">(</span><span class="s1">name </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span><span class="s1"> text</span><span class="s7">:</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">name</span><span class="s7">}</span><span class="s8">: </span><span class="s7">${</span><span class="s1">data</span><span class="s7">[</span><span class="s1">name</span><span class="s7">]}</span><span class="s8">`</span><span class="s7">,</span><span class="s1"> hwClass</span><span class="s7">:</span><span class="s1"> name </span><span class="s7">}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> existingTasks </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">db </span><span class="s7">&amp;&amp;</span><span class="s1"> auth </span><span class="s7">&amp;&amp;</span><span class="s1"> isAuthReady </span><span class="s7">&amp;&amp;</span><span class="s1"> userId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Fetching today's schedule from Firestore."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> scheduleDocRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">effectiveAppId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">/schedules`</span><span class="s7">,</span><span class="s1"> todayDate</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> scheduleDocSnap </span><span class="s7">=</span><span class="s1"> </span><span class="s12">await</span><span class="s1"> getDoc</span><span class="s7">(</span><span class="s1">scheduleDocRef</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>existingTasks </span><span class="s7">=</span><span class="s1"> scheduleDocSnap</span><span class="s7">.</span><span class="s1">exists</span><span class="s7">()</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> scheduleDocSnap</span><span class="s7">.</span><span class="s1">data</span><span class="s7">().</span><span class="s1">tasks </span><span class="s7">||</span><span class="s1"> </span><span class="s7">[]</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s7">[];</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Existing schedule tasks:"</span><span class="s7">,</span><span class="s4"> existingTasks</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Operating offline, fetching schedule from local memory."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>existingTasks </span><span class="s7">=</span><span class="s1"> localScheduleData</span><span class="s7">.</span><span class="s1">tasks</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> userAddedTasks </span><span class="s7">=</span><span class="s1"> existingTasks</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">t </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">!</span><span class="s1">t</span><span class="s7">.</span><span class="s1">hwClass</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> updatedHwTasks </span><span class="s7">=</span><span class="s1"> hwTasks</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">newHwTask </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> existingVersion </span><span class="s7">=</span><span class="s1"> existingTasks</span><span class="s7">.</span><span class="s1">find</span><span class="s7">(</span><span class="s1">t </span><span class="s7">=&gt;</span><span class="s1"> t</span><span class="s7">.</span><span class="s1">hwClass </span><span class="s7">===</span><span class="s1"> newHwTask</span><span class="s7">.</span><span class="s1">hwClass</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s12">return</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>id</span><span class="s7">:</span><span class="s1"> existingVersion </span><span class="s7">?</span><span class="s1"> existingVersion</span><span class="s7">.</span><span class="s1">id </span><span class="s7">:</span><span class="s1"> </span><span class="s8">`task-</span><span class="s7">${</span><span class="s1">newHwTask</span><span class="s7">.</span><span class="s1">hwClass</span><span class="s7">}</span><span class="s8">-</span><span class="s7">${</span><span class="s13">Date</span><span class="s7">.</span><span class="s1">now</span><span class="s7">()}</span><span class="s8">`</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>text</span><span class="s7">:</span><span class="s1"> newHwTask</span><span class="s7">.</span><span class="s1">text</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>time</span><span class="s7">:</span><span class="s1"> existingVersion </span><span class="s7">?</span><span class="s1"> existingVersion</span><span class="s7">.</span><span class="s1">time </span><span class="s7">:</span><span class="s1"> </span><span class="s14">30</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>hwClass</span><span class="s7">:</span><span class="s1"> newHwTask</span><span class="s7">.</span><span class="s1">hwClass</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> finalTasks </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[...</span><span class="s1">userAddedTasks</span><span class="s7">,</span><span class="s1"> </span><span class="s7">...</span><span class="s1">updatedHwTasks</span><span class="s7">];</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"updateTonightSchedule: Final tasks for schedule:"</span><span class="s7">,</span><span class="s4"> finalTasks</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">await</span><span class="s1"> saveSchedule</span><span class="s7">(</span><span class="s1">finalTasks</span><span class="s7">,</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start-time'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Saves homework data for a specific date and class.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {string} date - The date (YYYY-MM-DD).</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {string} className - The class name (e.g., "Math").</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {string} value - The homework assignment description.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> saveHomework</span><span class="s7">(</span><span class="s1">date</span><span class="s7">,</span><span class="s1"> className</span><span class="s7">,</span><span class="s1"> value</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">`saveHomework: Saving homework for </span><span class="s7">${</span><span class="s4">date</span><span class="s7">}</span><span class="s1">, class </span><span class="s7">${</span><span class="s4">className</span><span class="s7">}</span><span class="s1">: </span><span class="s7">${</span><span class="s4">value</span><span class="s7">}</span><span class="s1">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">db </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">auth </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">isAuthReady </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">userId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">warn</span><span class="s7">(</span><span class="s1">"saveHomework: Firebase not ready or user not logged in, saving to local memory."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">localHomeworkData</span><span class="s7">[</span><span class="s1">date</span><span class="s7">])</span><span class="s1"> localHomeworkData</span><span class="s7">[</span><span class="s1">date</span><span class="s7">]</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>localHomeworkData</span><span class="s7">[</span><span class="s1">date</span><span class="s7">][</span><span class="s1">className</span><span class="s7">]</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"saveHomework: Saving to Firestore."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> docRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">effectiveAppId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">/homework`</span><span class="s7">,</span><span class="s1"> date</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">docRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s7">[</span><span class="s1">className</span><span class="s7">]:</span><span class="s1"> value </span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> merge</span><span class="s7">:</span><span class="s1"> </span><span class="s12">true</span><span class="s1"> </span><span class="s7">});</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"saveHomework: Successfully saved to Firestore."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Error saving homework: "</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">date </span><span class="s7">===</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s1">getTomorrowDate</span><span class="s7">()))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>updateTonightSchedule</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Saves today's schedule tasks and start time.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Array&lt;Object&gt;} tasks - An array of task objects.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {string} startTime - The start time for the schedule (e.g., "18:00").</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">async</span><span class="s1"> </span><span class="s12">function</span><span class="s1"> saveSchedule</span><span class="s7">(</span><span class="s1">tasks</span><span class="s7">,</span><span class="s1"> startTime</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"saveSchedule: Saving schedule tasks. Num tasks:"</span><span class="s7">,</span><span class="s4"> tasks</span><span class="s7">.</span><span class="s4">length</span><span class="s7">,</span><span class="s4"> </span><span class="s1">"Start time:"</span><span class="s7">,</span><span class="s4"> startTime</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">db </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">auth </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">isAuthReady </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">userId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                 </span>console</span><span class="s7">.</span><span class="s4">warn</span><span class="s7">(</span><span class="s1">"saveSchedule: Firebase not ready or user not logged in, saving to local memory and rendering."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>localScheduleData </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> tasks</span><span class="s7">,</span><span class="s1"> startTime </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>renderScheduleList</span><span class="s7">(</span><span class="s1">tasks</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s12">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"saveSchedule: Saving to Firestore."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> todayDate </span><span class="s7">=</span><span class="s1"> formatDate</span><span class="s7">(</span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> docRef </span><span class="s7">=</span><span class="s1"> doc</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`artifacts/</span><span class="s7">${</span><span class="s1">effectiveAppId</span><span class="s7">}</span><span class="s8">/users/</span><span class="s7">${</span><span class="s1">userId</span><span class="s7">}</span><span class="s8">/schedules`</span><span class="s7">,</span><span class="s1"> todayDate</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">await</span><span class="s1"> setDoc</span><span class="s7">(</span><span class="s1">docRef</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> tasks</span><span class="s7">,</span><span class="s1"> startTime </span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> merge</span><span class="s7">:</span><span class="s1"> </span><span class="s12">true</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"saveSchedule: Successfully saved to Firestore."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s8">"Error saving schedule: "</span><span class="s7">,</span><span class="s1"> error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Schedule Rendering and Logic ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Renders the list of tasks for "Tonight's Schedule".</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Array&lt;Object&gt;} tasks - An array of task objects to render.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> renderScheduleList</span><span class="s7">(</span><span class="s1">tasks</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"renderScheduleList: Rendering schedule list. Tasks:"</span><span class="s7">,</span><span class="s4"> tasks</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>scheduleList</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">tasks </span><span class="s7">||</span><span class="s1"> tasks</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>scheduleList</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-gray-500 text-center p-4"&gt;No tasks for tonight. Add some or relax!&lt;/p&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>tasks</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">task </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> taskEl </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'div'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>taskEl</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'task-item flex items-center gap-4 p-4 bg-white border border-gray-200 rounded-xl shadow-sm'</span><span class="s7">;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>taskEl</span><span class="s7">.</span><span class="s1">draggable </span><span class="s7">=</span><span class="s1"> </span><span class="s12">true</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>taskEl</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">taskId </span><span class="s7">=</span><span class="s1"> task</span><span class="s7">.</span><span class="s1">id</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">task</span><span class="s7">.</span><span class="s1">hwClass</span><span class="s7">)</span><span class="s1"> taskEl</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">hwClass </span><span class="s7">=</span><span class="s1"> task</span><span class="s7">.</span><span class="s1">hwClass</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>taskEl</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;i class="fas fa-grip-vertical text-gray-400 cursor-move text-xl"&gt;&lt;/i&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;span class="flex-grow text-gray-800 text-lg"&gt;</span><span class="s7">${</span><span class="s4">task</span><span class="s7">.</span><span class="s4">text</span><span class="s7">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="number" value="</span><span class="s7">${</span><span class="s4">task</span><span class="s7">.</span><span class="s4">time </span><span class="s7">||</span><span class="s4"> </span><span class="s14">30</span><span class="s7">}</span><span class="s1">" min="5" step="5" class="class-input w-24 text-center time-estimate"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;span class="text-md text-gray-500 flex-shrink-0"&gt;min&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button class="btn-red remove-task text-xl"&gt;&lt;i class="fas fa-trash"&gt;&lt;/i&gt;&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>scheduleList</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">taskEl</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateTotalTime</span><span class="s7">();</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Calculates and displays the total estimated time for all tasks in the schedule.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> updateTotalTime</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> tasks </span><span class="s7">=</span><span class="s1"> getCurrentScheduleTasks</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> totalMinutes </span><span class="s7">=</span><span class="s1"> tasks</span><span class="s7">.</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">sum</span><span class="s7">,</span><span class="s1"> task</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> sum </span><span class="s7">+</span><span class="s1"> </span><span class="s7">(</span><span class="s1">task</span><span class="s7">.</span><span class="s1">time </span><span class="s7">||</span><span class="s1"> </span><span class="s14">0</span><span class="s7">),</span><span class="s1"> </span><span class="s14">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">totalMinutes </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>totalTimeDisplay</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Total Time: 0m'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> hours </span><span class="s7">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s7">.</span><span class="s1">floor</span><span class="s7">(</span><span class="s1">totalMinutes </span><span class="s7">/</span><span class="s1"> </span><span class="s14">60</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> minutes </span><span class="s7">=</span><span class="s1"> totalMinutes </span><span class="s7">%</span><span class="s1"> </span><span class="s14">60</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> timeString </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Total Time: '</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">hours </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> timeString </span><span class="s7">+=</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">hours</span><span class="s7">}</span><span class="s8">h `</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">minutes </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> timeString </span><span class="s7">+=</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">minutes</span><span class="s7">}</span><span class="s8">m`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>totalTimeDisplay</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> timeString</span><span class="s7">.</span><span class="s1">trim</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Generates and displays the detailed timeline based on tasks and start time.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> generateTimeline</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"generateTimeline: Generating timeline."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> startTimeValue </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start-time'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">startTimeValue</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">warn</span><span class="s7">(</span><span class="s1">"generateTimeline: Start time not set."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> btn </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'generate-schedule-btn'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> originalText </span><span class="s7">=</span><span class="s1"> btn</span><span class="s7">.</span><span class="s1">innerHTML</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> originalClasses </span><span class="s7">=</span><span class="s1"> btn</span><span class="s7">.</span><span class="s1">className</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>btn</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'&lt;i class="fas fa-exclamation-triangle"&gt;&lt;/i&gt; Please set a start time first!'</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>btn</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'btn-primary w-full py-4 bg-red-500 hover:bg-red-600'</span><span class="s7">;</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout</span><span class="s7">(()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> btn</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> originalText</span><span class="s7">;</span><span class="s1"> btn</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> originalClasses</span><span class="s7">;</span><span class="s1"> </span><span class="s7">},</span><span class="s1"> </span><span class="s14">2500</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> </span><span class="s7">[</span><span class="s1">hours</span><span class="s7">,</span><span class="s1"> minutes</span><span class="s7">]</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> startTimeValue</span><span class="s7">.</span><span class="s1">split</span><span class="s7">(</span><span class="s8">':'</span><span class="s7">).</span><span class="s1">map</span><span class="s7">(</span><span class="s13">Number</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> currentTime </span><span class="s7">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentTime</span><span class="s7">.</span><span class="s1">setHours</span><span class="s7">(</span><span class="s1">hours</span><span class="s7">,</span><span class="s1"> minutes</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"> </span><span class="s14">0</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>timelineOutput</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'&lt;h3 class="text-2xl font-bold text-gray-800 mb-4 border-b border-gray-200 pb-2"&gt;Your Timeline&lt;/h3&gt;'</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> taskItems </span><span class="s7">=</span><span class="s1"> getCurrentScheduleTasks</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">taskItems</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s14">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                 </span>timelineOutput</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">+=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-gray-500"&gt;No tasks to schedule. Add some above!&lt;/p&gt;`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s12">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>taskItems</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">task </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> duration </span><span class="s7">=</span><span class="s1"> task</span><span class="s7">.</span><span class="s1">time </span><span class="s7">||</span><span class="s1"> </span><span class="s14">30</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> startTimeStr </span><span class="s7">=</span><span class="s1"> currentTime</span><span class="s7">.</span><span class="s1">toLocaleTimeString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> hour</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'2-digit'</span><span class="s7">,</span><span class="s1"> minute</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'2-digit'</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> endTime </span><span class="s7">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Date</span><span class="s7">(</span><span class="s1">currentTime</span><span class="s7">.</span><span class="s1">getTime</span><span class="s7">()</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> duration </span><span class="s7">*</span><span class="s1"> </span><span class="s14">60000</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> endTimeStr </span><span class="s7">=</span><span class="s1"> endTime</span><span class="s7">.</span><span class="s1">toLocaleTimeString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> hour</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'2-digit'</span><span class="s7">,</span><span class="s1"> minute</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'2-digit'</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> timelineItem </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'div'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>timelineItem</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'timeline-item p-4 bg-indigo-50 rounded-xl flex items-center gap-4 shadow-sm'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>timelineItem</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" class="h-6 w-6 rounded-md border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;span class="flex-grow font-medium text-indigo-800 text-lg"&gt;</span><span class="s7">${</span><span class="s4">task</span><span class="s7">.</span><span class="s4">text</span><span class="s7">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong class="font-semibold text-indigo-900 text-md"&gt;</span><span class="s7">${</span><span class="s4">startTimeStr</span><span class="s7">}</span><span class="s1"> - </span><span class="s7">${</span><span class="s4">endTimeStr</span><span class="s7">}</span><span class="s1">&lt;/strong&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>timelineOutput</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">timelineItem</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>currentTime </span><span class="s7">=</span><span class="s1"> endTime</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>saveSchedule</span><span class="s7">(</span><span class="s1">getCurrentScheduleTasks</span><span class="s7">(),</span><span class="s1"> startTimeValue</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Retrieves the current list of tasks from the schedule list DOM elements.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @returns {Array&lt;Object&gt;} - An array of task objects.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> getCurrentScheduleTasks</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> </span><span class="s13">Array</span><span class="s7">.</span><span class="s12">from</span><span class="s7">(</span><span class="s1">scheduleList</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'.task-item'</span><span class="s7">)).</span><span class="s1">map</span><span class="s7">(</span><span class="s1">item </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>id</span><span class="s7">:</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">taskId</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>text</span><span class="s7">:</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">querySelector</span><span class="s7">(</span><span class="s8">'span'</span><span class="s7">).</span><span class="s1">textContent</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>time</span><span class="s7">:</span><span class="s1"> parseInt</span><span class="s7">(</span><span class="s1">item</span><span class="s7">.</span><span class="s1">querySelector</span><span class="s7">(</span><span class="s8">'.time-estimate'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">,</span><span class="s1"> </span><span class="s14">10</span><span class="s7">)</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s14">0</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">...(</span><span class="s1">item</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">hwClass </span><span class="s7">&amp;&amp;</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> hwClass</span><span class="s7">:</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">.</span><span class="s1">hwClass </span><span class="s7">})</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Event Listeners ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Auth buttons</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>registerBtn</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> handleRegister</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>loginBtn</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> handleLogin</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>logoutBtn</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> handleLogout</span><span class="s7">);</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Calendar navigation</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'prev-week'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Event: Previous week button clicked."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentMonday</span><span class="s7">.</span><span class="s1">setDate</span><span class="s7">(</span><span class="s1">currentMonday</span><span class="s7">.</span><span class="s1">getDate</span><span class="s7">()</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> </span><span class="s14">7</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderWeek</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setupTomorrowHomeworkListener</span><span class="s7">();</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'next-week'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Event: Next week button clicked."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentMonday</span><span class="s7">.</span><span class="s1">setDate</span><span class="s7">(</span><span class="s1">currentMonday</span><span class="s7">.</span><span class="s1">getDate</span><span class="s7">()</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s14">7</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderWeek</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setupTomorrowHomeworkListener</span><span class="s7">();</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Homework input save</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>calendarGrid</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'focusout'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">matches</span><span class="s7">(</span><span class="s8">'.class-input'</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Event: Homework input focusout."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> date</span><span class="s7">,</span><span class="s1"> </span><span class="s12">class</span><span class="s7">:</span><span class="s1"> className </span><span class="s7">}</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">dataset</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>saveHomework</span><span class="s7">(</span><span class="s1">date</span><span class="s7">,</span><span class="s1"> className</span><span class="s7">,</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">value</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Add custom task</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'add-task-btn'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Event: Add task button clicked."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> input </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'custom-task-input'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> text </span><span class="s7">=</span><span class="s1"> input</span><span class="s7">.</span><span class="s1">value</span><span class="s7">.</span><span class="s1">trim</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">text</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> tasks </span><span class="s7">=</span><span class="s1"> getCurrentScheduleTasks</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>tasks</span><span class="s7">.</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> id</span><span class="s7">:</span><span class="s1"> </span><span class="s8">`task-custom-</span><span class="s7">${</span><span class="s13">Date</span><span class="s7">.</span><span class="s1">now</span><span class="s7">()}</span><span class="s8">`</span><span class="s7">,</span><span class="s1"> text</span><span class="s7">:</span><span class="s1"> text</span><span class="s7">,</span><span class="s1"> time</span><span class="s7">:</span><span class="s1"> </span><span class="s14">30</span><span class="s1"> </span><span class="s7">});</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>saveSchedule</span><span class="s7">(</span><span class="s1">tasks</span><span class="s7">,</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start-time'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>input</span><span class="s7">.</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Schedule item time estimate change</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>scheduleList</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'change'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">matches</span><span class="s7">(</span><span class="s8">'.time-estimate'</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                 </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Event: Time estimate changed."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>saveSchedule</span><span class="s7">(</span><span class="s1">getCurrentScheduleTasks</span><span class="s7">(),</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start-time'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Remove task</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>scheduleList</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">closest</span><span class="s7">(</span><span class="s8">'.remove-task'</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Event: Remove task button clicked."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> taskItem </span><span class="s7">=</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">closest</span><span class="s7">(</span><span class="s8">'.task-item'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>taskItem</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">();</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>saveSchedule</span><span class="s7">(</span><span class="s1">getCurrentScheduleTasks</span><span class="s7">(),</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start-time'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Generate timeline</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'generate-schedule-btn'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'click'</span><span class="s7">,</span><span class="s1"> generateTimeline</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Timeline checkbox (mark completed)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>timelineOutput</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'change'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">matches</span><span class="s7">(</span><span class="s8">'input[type="checkbox"]'</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">log</span><span class="s7">(</span><span class="s1">"Event: Timeline checkbox toggled."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">closest</span><span class="s7">(</span><span class="s8">'.timeline-item'</span><span class="s7">).</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">toggle</span><span class="s7">(</span><span class="s8">'completed'</span><span class="s7">,</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">checked</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Drag and Drop Logic for Schedule Items ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> draggedItem </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>scheduleList</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'dragstart'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">contains</span><span class="s7">(</span><span class="s8">'task-item'</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">log</span><span class="s7">(</span><span class="s8">"Event: Drag start."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draggedItem </span><span class="s7">=</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout</span><span class="s7">(()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'dragging'</span><span class="s7">),</span><span class="s1"> </span><span class="s14">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>scheduleList</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'dragend'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s7">(</span><span class="s1">draggedItem</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">log</span><span class="s7">(</span><span class="s8">"Event: Drag end."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draggedItem</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'dragging'</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>draggedItem </span><span class="s7">=</span><span class="s1"> </span><span class="s12">null</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>saveSchedule</span><span class="s7">(</span><span class="s1">getCurrentScheduleTasks</span><span class="s7">(),</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start-time'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>scheduleList</span><span class="s7">.</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'dragover'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>e</span><span class="s7">.</span><span class="s1">preventDefault</span><span class="s7">();</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> afterElement </span><span class="s7">=</span><span class="s1"> getDragAfterElement</span><span class="s7">(</span><span class="s1">scheduleList</span><span class="s7">,</span><span class="s1"> e</span><span class="s7">.</span><span class="s1">clientY</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> currentDragged </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">querySelector</span><span class="s7">(</span><span class="s8">'.dragging'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentDragged</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">afterElement </span><span class="s7">==</span><span class="s1"> </span><span class="s12">null</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>scheduleList</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">currentDragged</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>scheduleList</span><span class="s7">.</span><span class="s1">insertBefore</span><span class="s7">(</span><span class="s1">currentDragged</span><span class="s7">,</span><span class="s1"> afterElement</span><span class="s7">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s10">/**</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* Determines where to place a dragged element within its container.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {HTMLElement} container - The parent container for draggable elements.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @param {number} y - The Y-coordinate of the mouse/touch.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>* @returns {HTMLElement|null} - The element to insert before, or null if it should be appended.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> getDragAfterElement</span><span class="s7">(</span><span class="s1">container</span><span class="s7">,</span><span class="s1"> y</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> draggableElements </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[...</span><span class="s1">container</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'.task-item:not(.dragging)'</span><span class="s7">)];</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> draggableElements</span><span class="s7">.</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">closest</span><span class="s7">,</span><span class="s1"> child</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> box </span><span class="s7">=</span><span class="s1"> child</span><span class="s7">.</span><span class="s1">getBoundingClientRect</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> offset </span><span class="s7">=</span><span class="s1"> y </span><span class="s7">-</span><span class="s1"> box</span><span class="s7">.</span><span class="s1">top </span><span class="s7">-</span><span class="s1"> box</span><span class="s7">.</span><span class="s1">height </span><span class="s7">/</span><span class="s1"> </span><span class="s14">2</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">offset </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> offset </span><span class="s7">&gt;</span><span class="s1"> closest</span><span class="s7">.</span><span class="s1">offset</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">return</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> offset</span><span class="s7">:</span><span class="s1"> offset</span><span class="s7">,</span><span class="s1"> element</span><span class="s7">:</span><span class="s1"> child </span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">return</span><span class="s1"> closest</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">},</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> offset</span><span class="s7">:</span><span class="s1"> </span><span class="s13">Number</span><span class="s7">.</span><span class="s13">NEGATIVE_INFINITY</span><span class="s1"> </span><span class="s7">}).</span><span class="s1">element</span><span class="s7">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
</body>
</html>
